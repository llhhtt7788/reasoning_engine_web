# --------------------------------------------------------------------------------------
# Environment variables reference (for dev + production)
#
# This project uses TWO kinds of API configuration:
#
# 1) Browser -> Chat API endpoint
#    - Used directly in the browser for chat streaming.
#    - Configured via: NEXT_PUBLIC_API_URL
#
# 2) Server (Next.js) -> Backend origin ("base URL")
#    - Used by Next.js Route Handlers under `app/api/**` to proxy requests to the backend.
#    - Mainly used for Knowledge Uploads and some other server-side proxy routes.
#    - Configured via: NEXT_PUBLIC_BACKEND_BASE_URL (or NEXT_PUBLIC_BACKEND_URL as fallback)
#
# Important notes for production:
# - The Next.js server must be able to reach this backend origin from inside the server/network.
# - If NEXT_PUBLIC_BACKEND_BASE_URL is NOT set, some proxy routes fall back to http://localhost:11211,
#   which is almost always WRONG in production and will cause 500/502 errors.
# --------------------------------------------------------------------------------------

# =========================
# 1) Chat API endpoint (browser)
# =========================
# Chat endpoint used by the frontend to send messages.
#
# ✅ Recommended (local dev, avoid CORS): use a relative path and let Next.js forward/proxy.
#   NEXT_PUBLIC_API_URL=/api/v1/chat/context
#
# ✅ Recommended (production): point to your public backend chat endpoint (must be reachable by users).
#   NEXT_PUBLIC_API_URL=https://your-backend.example.com/api/v1/chat/context
#
# ⚠️ Do NOT hardcode localhost in production builds.
#
# ⚠️ Keep this as an endpoint (includes the /api/v1/... path). For chat streaming,
#    stream parameters are appended by the client as needed; you generally should NOT bake
#    "?stream=true&sse=true" into the env value unless you really want it always-on.
NEXT_PUBLIC_API_URL=http://localhost:11211/api/v1/chat/context

# =========================
# 2) Backend origin for Next.js server-side proxy routes
# =========================
# Backend base URL ("origin") used by Next.js server route handlers to call your backend.
# MUST be ONLY protocol + host + optional port.
#
# ✅ Good:
#   NEXT_PUBLIC_BACKEND_BASE_URL=http://localhost:11211
#   NEXT_PUBLIC_BACKEND_BASE_URL=https://your-backend.example.com
#   NEXT_PUBLIC_BACKEND_BASE_URL=http://10.0.0.12:11211
#
# ❌ Bad (will produce /api/api/...):
#   NEXT_PUBLIC_BACKEND_BASE_URL=https://your-backend.example.com/api
#
# Why needed?
# - Knowledge Uploads list/detail/upload call Next routes:
#     /api/knowledge/documents
#     /api/knowledge/documents/upload
#   Those Next routes will forward to:
#     ${NEXT_PUBLIC_BACKEND_BASE_URL}/api/knowledge/documents...
#
# If your backend is on another host in prod, you MUST set this.
NEXT_PUBLIC_BACKEND_BASE_URL=http://localhost:11211

# =========================
# Optional: request logging for proxy routes (server-side)
# =========================
# ENABLE_REQUEST_LOGS=1
# REQUEST_LOG_DIR=logs
# REQUEST_LOG_MAX_BYTES=262144

# =========================
# Optional identity defaults (used when UI doesn't provide them)
# =========================
# NEXT_PUBLIC_USER_ID=10001
# NEXT_PUBLIC_TENANT_ID=
# NEXT_PUBLIC_APP_ID=
# NEXT_PUBLIC_THREAD_ID=

# =========================
# Optional model/prompt parameters
# =========================
# NEXT_PUBLIC_SYSTEM_PROMPT=你是一个有用的AI助手
# NEXT_PUBLIC_LLM_INDEX=0

